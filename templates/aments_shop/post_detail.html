{% extends 'aments_shop/base.html' %}
{% load static %}
{% block content %}

    <!-- ...:::: Start Breadcrumb Section:::... -->
    <div class="breadcrumb-section">
        <div class="breadcrumb-wrapper">
            <div class="container">
                <div class="row">
                    <div class="col-12 d-flex justify-content-between justify-content-md-between  align-items-center flex-md-row flex-column">
                        <h3 class="breadcrumb-title">{{ post.title }}</h3>
                        <div class="breadcrumb-nav">
                            <nav aria-label="breadcrumb">
                                <ul>
                                    <li><a href="{% url 'home' %}">Home</a></li>
                                    <li><a href="{% url 'posts' %}">Posts</a></li>
                                    <li class="active" aria-current="page">{{ post.title }}</li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- ...:::: End Breadcrumb Section:::... -->

    <!-- ...:::: Start Blog Single Section:::... -->
    <div class="blog-single-section">
        <div class="container">
            <div class="row flex-column-reverse flex-lg-row">
                <div class="col-lg-3">
                    <!-- Start Sidebar Area -->
                    <div class="siderbar-section">

                        <!-- Start Single Sidebar Widget -->
                        <div class="sidebar-single-widget">
                            <h6 class="sidebar-title">Search</h6>
                            <div class="sidebar-content">
                                <div class="search-bar">
                                    <div class="default-search-style d-flex">
                                        <input class="default-search-style-input-box border-around border-right-none"
                                               type="search" placeholder="Search..." required>
                                        <button class="default-search-style-input-btn" type="submit"><i
                                                class="icon-search"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div> <!-- End Single Sidebar Widget -->

                        <!-- Start Single Sidebar Widget -->
                        <div class="sidebar-single-widget">
                            <h6 class="sidebar-title">Recent Post</h6>
                            <div class="sidebar-content">
                                <div class="recent-post">
                                    <ul>
                                        <!-- Start Single Recent Post Item -->
                                        <li class="recent-post-list">
                                            <a href="post_detail.html" class="post-image">
                                                <img src="../../static/images/blog_recent_post/blog1.jpg" alt="">
                                            </a>
                                            <div class="post-content">
                                                <a class="post-link" href="post_detail.html">Blog Image
                                                    Post</a>
                                                <span class="post-date">March 16, 2018</span>
                                            </div>
                                        </li> <!-- End Single Recent Post Item -->
                                        <!-- Start Single Recent Post Item -->
                                        <li class="recent-post-list">
                                            <a href="post_detail.html" class="post-image">
                                                <img src="../../static/images/blog_recent_post/blog2.jpg" alt="">
                                            </a>
                                            <div class="post-content">
                                                <a class="post-link" href="post_detail.html">Blog Image
                                                    Post</a>
                                                <span class="post-date">March 16, 2018</span>
                                            </div>
                                        </li> <!-- End Single Recent Post Item -->
                                        <!-- Start Single Recent Post Item -->
                                        <li class="recent-post-list">
                                            <a href="post_detail.html" class="post-image">
                                                <img src="../../static/images/blog_recent_post/blog3.jpg" alt="">
                                            </a>
                                            <div class="post-content">
                                                <a class="post-link" href="post_detail.html">Blog Image
                                                    Post</a>
                                                <span class="post-date">March 16, 2018</span>
                                            </div>
                                        </li> <!-- End Single Recent Post Item -->
                                    </ul>
                                </div>
                            </div>
                        </div> <!-- End Single Sidebar Widget -->

                        <!-- Start Single Sidebar Widget -->
                        <div class="sidebar-single-widget">
                            <h6 class="sidebar-title">Tag products</h6>
                            <div class="sidebar-content">
                                <div class="tag-link">
                                    <a href="">asian</a>
                                    <a href="">brown</a>
                                    <a href="">euro</a>
                                    <a href="">fashion</a>
                                    <a href="">hat</a>
                                    <a href="">t-shirt</a>
                                    <a href="">teen</a>
                                    <a href="">travel</a>
                                    <a href="">white</a>
                                </div>
                            </div>
                        </div> <!-- End Single Sidebar Widget -->

                    </div> <!-- End Sidebar Area -->
                </div>
                <div class="col-lg-9">
                    <!-- Start Blog Single Content Area -->
                    <div class="blog-single-wrapper">
                        <div class="blog-single-img">
                            <img class="img-fluid" src="{{ post.preview.url }}" alt="">
                        </div>
                        <div class="blog-feed-post-meta">
                            <span>By:</span>
                            <a href="" class="blog-feed-post-meta-author">{{ post.author.username }}</a> -
                            <a href="" class="blog-feed-post-meta-date">{{ post.publish_date.date }}</a>
                        </div>
                        <h4 class="post-title">{{ post.title }}</h4>
                        <div class="para-content">
                            <p>{{ post.text }}</p>
                        </div>
                        <div class="para-tags">
                            <span>Tags: </span>
                            {% for tag in post.tags.all %}
                                <ul>
                                    <li><a href="">{{ tag.name }}</a></li>
                                </ul>
                            {% endfor %}
                        </div>
                    </div> <!-- End Blog Single Content Area -->
                    <div class="comment-area">
                        <h4 class="mb-30">{{ post.postreview_set.count }} Comments</h4>
                        <!-- Start - Review Comment -->
                        <ul class="comment">
                            <!-- Start - Review Comment list-->
                            {% for review in post.get_review %}
                                <li class="comment-list">
                                    <div class="comment-wrapper">
                                        <div class="comment-img">
                                            <img src="{% static 'images/user/image-1.png' %}" alt="">
                                        </div>
                                        <div class="comment-content">
                                            <div class="comment-content-top">
                                                <div class="comment-content-left">
                                                    <h6 class="comment-name">{{ review.name }}</h6>
                                                </div>
                                                <div class="comment-content-right">
                                                    <a href="#addComment"
                                                       onclick="addPostReview('{{ review.name }}', '{{ review.id }}')">
                                                        <i class="fa fa-reply"></i>Reply
                                                    </a>
                                                </div>
                                            </div>

                                            <div class="para-content">
                                                <p>{{ review.text }}</p>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Start - Review Comment Reply-->
                                    <ul class="comment-reply">
                                        {% for child_rev in review.postreview_set.all %}
                                            <li class="comment-reply-list">
                                                <div class="comment-wrapper">
                                                    <div class="comment-img">
                                                        <img src="{% static 'images/user/image-2.png' %}" alt="">
                                                    </div>
                                                    <div class="comment-content">
                                                        <div class="comment-content-top">
                                                            <div class="comment-content-left">
                                                                <h6 class="comment-name">{{ child_rev.name }}</h6>
                                                            </div>
                                                            <div class="comment-content-right">
                                                                <a href="#addComment"
                                                                   onclick="addPostReview('{{ review.name }}', '{{ review.id }}')">
                                                                    <i class="fa fa-reply"></i>Reply
                                                                </a>
                                                            </div>
                                                        </div>

                                                        <div class="para-content">
                                                            <p>{{ child_rev.text }}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </li>
                                        {% endfor %}

                                    </ul> <!-- End - Review Comment Reply-->
                                </li> <!-- End - Review Comment list-->
                            {% endfor %}

                        </ul> <!-- End - Review Comment -->

                        <!-- Start comment Form -->
                        <div class="comment-form">
                            <div class="coment-form-text-top mt-30">
                                <h4>Leave a Reply</h4>
                            </div>

                            <form id="addComment" action="{% url 'add_post_review' post.id %}" method="post">
                                {% csrf_token %}
                                <div class="row">
                                    <input type="hidden" name="parent" id="parent-comment" value="">
                                    {% if request.user.is_authenticated %}
                                        <input name="customer" type="hidden" value="{{ request.user.id }}">
                                        <input name="name" id="comment-name" type="hidden"
                                               value="{{ request.user.username }}">
                                        <input name="email" id="comment-email" type="hidden"
                                               value="{{ request.user.email }}">
                                    {% else %}
                                        <div class="col-md-6">
                                            <div class="default-form-box mb-20">
                                                <label for="comment-name">Your name<span>*</span></label>
                                                <input name="name" id="comment-name" type="text"
                                                       placeholder="Enter your name" required>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="default-form-box mb-20">
                                                <label for="comment-email">Your Email <span>*</span></label>
                                                <input name="email" id="comment-email" type="email"
                                                       placeholder="Enter your email" required>
                                            </div>
                                        </div>
                                    {% endif %}
                                    <div class="col-12">
                                        <div class="default-form-box mb-20">
                                            <label for="comment-review-text">Your review <span>*</span></label>
                                            <textarea name="text" id="comment-review-text" placeholder="Write a review"
                                                      required></textarea>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <button class="form-submit-btn" type="submit">Post Comment</button>
                                    </div>
                                </div>
                            </form>
                        </div> <!-- End comment Form -->
                    </div>


                </div> <!-- End Shop Product Sorting Section  -->
            </div>
        </div>
    </div> <!-- ...:::: End Blog Single Section:::... -->

    <script type="text/javascript">
        function addPostReview(user, id) {
            document.getElementById("parent-comment").value = id;
            document.getElementById("comment-review-text").innerText = `${user}, `
        }
    </script>
{% endblock content %}